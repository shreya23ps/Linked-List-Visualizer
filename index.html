<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linked List Visualizer - Modern UI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #6b93d6;
            --secondary-color: #4cb5c3;
            --accent-color: #ffcc80;
            --background-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #e6e6e6;
            --text-light: #b3b3b3;
            --node-bg: #2d3748;
            --node-border: #4a5568;
            --node-value-bg: #4299e1;
            --pointer-color: #f6e05e;
            --success-color: #68d391;
            --warning-color: #f6ad55;
            --danger-color: #fc8181;
            --border-radius: 12px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
        }

        .light-mode {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4cb5c3;
            --background-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --text-light: #666666;
            --node-bg: #e2e8f0;
            --node-border: #cbd5e0;
            --node-value-bg: #4299e1;
            --pointer-color: #f6e05e;
            --success-color: #48bb78;
            --warning-color: #ed8936;
            --danger-color: #f56565;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            transition: var(--transition);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 0 10px;
        }

        .header-left {
            flex: 1;
            min-width: 300px;
        }

        .header-left h1 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 2.2rem;
        }

        .header-left .subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .theme-toggle {
            background: var(--card-bg);
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            color: var(--text-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: fit-content;
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            align-items: start;
        }

        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .visualization-section {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            min-height: 600px;
        }

        .controls-section {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 25px;
            transition: var(--transition);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .section-title {
            color: var(--secondary-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--accent-color);
            font-size: 1.4rem;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group h3 {
            margin-bottom: 12px;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 12px 16px;
            border: none;
            border-radius: var(--border-radius);
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
            min-width: 120px;
        }

        button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        button:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }

        button.active {
            background-color: var(--accent-color);
            color: #333;
        }

        button.success {
            background-color: var(--success-color);
        }

        button.warning {
            background-color: var(--warning-color);
        }

        button.danger {
            background-color: var(--danger-color);
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--node-border);
            border-radius: var(--border-radius);
            margin-bottom: 10px;
            background-color: var(--card-bg);
            color: var(--text-color);
            transition: var(--transition);
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .linked-list-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            padding: 20px;
            position: relative;
        }

        .list-type-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .type-tag {
            padding: 8px 16px;
            border-radius: 20px;
            background: var(--node-bg);
            color: var(--text-color);
            font-weight: 600;
            transition: var(--transition);
        }

        .type-tag.active {
            background: var(--accent-color);
            color: #333;
        }

        .nodes-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin: 20px 0;
            position: relative;
        }

        .node {
            display: flex;
            align-items: center;
            background: var(--node-bg);
            border: 2px solid var(--node-border);
            border-radius: 10px;
            padding: 10px;
            position: relative;
            transition: var(--transition);
            animation: nodeAppear 0.5s ease;
        }

        @keyframes nodeAppear {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .node.highlight {
            border-color: var(--accent-color);
            box-shadow: 0 0 15px var(--accent-color);
        }

        .node-value {
            background: var(--node-value-bg);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 0 10px;
        }

        .node-pointers {
            display: flex;
            gap: 10px;
        }

        .pointer {
            width: 40px;
            height: 40px;
            border: 2px solid var(--pointer-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .pointer::after {
            content: "→";
            color: var(--pointer-color);
            font-size: 1.2rem;
            font-weight: bold;
        }

        .pointer.prev::after {
            content: "←";
        }

        .pointer.null {
            background: var(--node-border);
        }

        .pointer.null::after {
            content: "X";
            color: var(--text-light);
        }

        .arrow {
            position: absolute;
            height: 2px;
            background: var(--pointer-color);
            top: 50%;
            transform: translateY(-50%);
        }

        .arrow::after {
            content: "";
            position: absolute;
            right: -8px;
            top: -4px;
            border: 6px solid transparent;
            border-left-color: var(--pointer-color);
        }

        .arrow.prev::after {
            right: auto;
            left: -8px;
            border-left-color: transparent;
            border-right-color: var(--pointer-color);
        }

        .info-section {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .algorithm-info {
            display: none;
        }

        .algorithm-info.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .algorithm-info h3 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .algorithm-info p {
            margin-bottom: 15px;
            line-height: 1.7;
        }

        .analogy-box {
            background: rgba(76, 181, 195, 0.1);
            border-left: 4px solid var(--accent-color);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }

        .analogy-box h4 {
            color: var(--accent-color);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .instructions {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(76, 181, 195, 0.1);
            border-radius: var(--border-radius);
            font-size: 0.95rem;
        }

        .instructions h4 {
            margin-bottom: 12px;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .instructions ul {
            padding-left: 20px;
            margin-bottom: 0;
        }

        .instructions li {
            margin-bottom: 8px;
            padding-left: 5px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .comparison-table th, .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--node-border);
        }

        .comparison-table th {
            background-color: rgba(76, 181, 195, 0.1);
            color: var(--secondary-color);
        }

        .comparison-table tr:hover {
            background-color: rgba(76, 181, 195, 0.05);
        }

        .faq-section {
            margin-top: 30px;
        }

        .faq-item {
            margin-bottom: 15px;
            border: 1px solid var(--node-border);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .faq-question {
            padding: 15px;
            background: var(--card-bg);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .faq-answer {
            padding: 0 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: rgba(76, 181, 195, 0.05);
        }

        .faq-item.active .faq-answer {
            padding: 15px;
            max-height: 500px;
        }

        .icon {
            font-size: 1.2rem;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--node-border);
        }

        .stat-item {
            text-align: center;
            padding: 10px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Circular list visualization */
        .circular-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        .circular-node {
            position: absolute;
            display: flex;
            align-items: center;
            background: var(--node-bg);
            border: 2px solid var(--node-border);
            border-radius: 10px;
            padding: 8px;
            transition: var(--transition);
        }

        .circular-node.highlight {
            border-color: var(--accent-color);
            box-shadow: 0 0 15px var(--accent-color);
        }

        .circular-node-value {
            background: var(--node-value-bg);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .circular-arrow {
            position: absolute;
            width: 2px;
            background: var(--pointer-color);
            transform-origin: 0 0;
        }

        .circular-arrow::after {
            content: "";
            position: absolute;
            right: -6px;
            top: -4px;
            border: 6px solid transparent;
            border-left-color: var(--pointer-color);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main-content {
                gap: 20px;
            }
            
            .visualization-section,
            .controls-section,
            .info-section {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                min-width: 100%;
            }
            
            .nodes-container {
                gap: 20px;
            }
            
            .node {
                flex-direction: column;
                padding: 8px;
            }
            
            .node-value {
                margin: 5px 0;
            }
            
            .node-pointers {
                gap: 5px;
            }
            
            .pointer {
                width: 30px;
                height: 30px;
            }
        }

        @media (max-width: 480px) {
            .header-left h1 {
                font-size: 1.8rem;
            }
            
            .header-left .subtitle {
                font-size: 1rem;
            }
            
            .theme-toggle {
                padding: 10px 16px;
                font-size: 0.9rem;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="dark-mode">
    <div class="container">
        <header>
            <div class="header-left">
                <h1>Linked List Visualizer</h1>
                <p class="subtitle">Visualize Singly, Doubly, and Circular Linked Lists with interactive operations</p>
            </div>
            <button class="theme-toggle" id="theme-toggle">
                <i class="fas fa-sun"></i> Light Mode
            </button>
        </header>

        <div class="main-content">
            <section class="visualization-section">
                <h2 class="section-title">Visualization</h2>
                
                <div class="list-type-indicator">
                    <div class="type-tag active" id="singly-tag">Singly Linked List</div>
                    <div class="type-tag" id="doubly-tag">Doubly Linked List</div>
                    <div class="type-tag" id="circular-tag">Circular Linked List</div>
                </div>
                
                <div class="linked-list-container">
                    <div class="nodes-container" id="nodes-container">
                        <!-- Nodes will be dynamically added here -->
                        <div class="empty-state">
                            <i class="fas fa-list-alt icon" style="font-size: 3rem; margin-bottom: 15px; color: var(--text-light);"></i>
                            <p style="color: var(--text-light);">Your linked list is empty. Add some nodes to get started!</p>
                        </div>
                    </div>
                </div>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="node-count">0</div>
                        <div class="stat-label">Nodes</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="list-type">Singly</div>
                        <div class="stat-label">List Type</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="memory-usage">0 KB</div>
                        <div class="stat-label">Memory</div>
                    </div>
                </div>
            </section>

            <section class="controls-section">
                <div class="control-group">
                    <h3><i class="fas fa-sliders-h"></i> List Operations</h3>
                    <div class="button-group">
                        <button id="add-head-btn" class="success">
                            <i class="fas fa-plus-circle"></i> Add Head
                        </button>
                        <button id="add-tail-btn" class="success">
                            <i class="fas fa-plus-square"></i> Add Tail
                        </button>
                    </div>
                    <div class="button-group">
                        <button id="remove-head-btn" class="danger">
                            <i class="fas fa-minus-circle"></i> Remove Head
                        </button>
                        <button id="remove-tail-btn" class="danger">
                            <i class="fas fa-minus-square"></i> Remove Tail
                        </button>
                    </div>
                    <div>
                        <label for="node-value">Node Value:</label>
                        <input type="number" id="node-value" placeholder="Enter value" min="1" max="100" value="10">
                    </div>
                </div>

                <div class="control-group">
                    <h3><i class="fas fa-search"></i> Search Operations</h3>
                    <div class="button-group">
                        <button id="search-btn" class="warning">
                            <i class="fas fa-search"></i> Search Value
                        </button>
                        <button id="clear-search-btn">
                            <i class="fas fa-eraser"></i> Clear Search
                        </button>
                    </div>
                </div>

                <div class="control-group">
                    <h3><i class="fas fa-cog"></i> List Controls</h3>
                    <div class="button-group">
                        <button id="reverse-btn">
                            <i class="fas fa-exchange-alt"></i> Reverse List
                        </button>
                        <button id="clear-list-btn" class="danger">
                            <i class="fas fa-trash"></i> Clear List
                        </button>
                    </div>
                </div>

                <div class="instructions">
                    <h4><i class="fas fa-graduation-cap"></i> How to Use:</h4>
                    <ul>
                        <li>Select a list type (Singly, Doubly, or Circular)</li>
                        <li>Enter a value and click "Add Head" or "Add Tail" to insert nodes</li>
                        <li>Use "Remove Head/Tail" to delete nodes from the list</li>
                        <li>Search for values to highlight specific nodes</li>
                        <li>Reverse the list to see how pointers change</li>
                    </ul>
                </div>
            </section>
        </div>

        <section class="info-section">
            <div id="singly-info" class="algorithm-info active">
                <h3><i class="fas fa-forward"></i> Singly Linked List</h3>
                
                <div class="analogy-box">
                    <h4><i class="fas fa-lightbulb"></i> Real-World Analogy</h4>
                    <p>A singly linked list is like a treasure hunt where each clue points to the next location. You can only move forward from one clue to the next, with no way to go back.</p>
                </div>
                
                <h4>How It Works:</h4>
                <ul>
                    <li>Each node contains data and a pointer to the next node</li>
                    <li>Traversal is unidirectional (forward only)</li>
                    <li>Memory efficient (only one pointer per node)</li>
                    <li>Insertion and deletion at head is O(1)</li>
                    <li>Insertion and deletion at tail is O(n)</li>
                </ul>
                
                <h4>When to Use Singly Linked List:</h4>
                <ul>
                    <li>When you only need forward traversal</li>
                    <li>Memory is a constraint</li>
                    <li>Frequent insertions/deletions at the beginning</li>
                    <li>Implementing stacks or simple queues</li>
                </ul>
            </div>
            
            <div id="doubly-info" class="algorithm-info">
                <h3><i class="fas fa-arrows-alt-h"></i> Doubly Linked List</h3>
                
                <div class="analogy-box">
                    <h4><i class="fas fa-lightbulb"></i> Real-World Analogy</h4>
                    <p>A doubly linked list is like a two-way street where you can travel in both directions. Each house has directions to both the next house and the previous one.</p>
                </div>
                
                <h4>How It Works:</h4>
                <ul>
                    <li>Each node contains data, a pointer to the next node, and a pointer to the previous node</li>
                    <li>Traversal is bidirectional (forward and backward)</li>
                    <li>Uses more memory (two pointers per node)</li>
                    <li>Insertion and deletion at both ends is O(1)</li>
                    <li>Easier to implement certain algorithms</li>
                </ul>
                
                <h4>When to Use Doubly Linked List:</h4>
                <ul>
                    <li>When you need bidirectional traversal</li>
                    <li>Implementing browsers' back/forward navigation</li>
                    <li>Music playlists with next/previous functionality</li>
                    <li>Undo/redo functionality in applications</li>
                </ul>
            </div>
            
            <div id="circular-info" class="algorithm-info">
                <h3><i class="fas fa-redo-alt"></i> Circular Linked List</h3>
                
                <div class="analogy-box">
                    <h4><i class="fas fa-lightbulb"></i> Real-World Analogy</h4>
                    <p>A circular linked list is like a circular train route where the last stop connects back to the first. You can keep going around the loop indefinitely.</p>
                </div>
                
                <h4>How It Works:</h4>
                <ul>
                    <li>The last node points back to the first node (singly circular)</li>
                    <li>Or both ends connect to each other (doubly circular)</li>
                    <li>No null pointers at the end (forms a cycle)</li>
                    <li>Useful for round-robin scheduling</li>
                    <li>Can be traversed indefinitely</li>
                </ul>
                
                <h4>When to Use Circular Linked List:</h4>
                <ul>
                    <li>Round-robin scheduling in operating systems</li>
                    <li>Implementing circular buffers</li>
                    <li>Music playlists that repeat</li>
                    <li>Multiplayer games with turn-based systems</li>
                </ul>
            </div>
            
            <div class="comparison-section">
                <h3 class="section-title"><i class="fas fa-balance-scale"></i> Comparison Table</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Operation</th>
                            <th>Singly</th>
                            <th>Doubly</th>
                            <th>Circular</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Insert at Head</td>
                            <td>O(1)</td>
                            <td>O(1)</td>
                            <td>O(1)</td>
                        </tr>
                        <tr>
                            <td>Insert at Tail</td>
                            <td>O(n)</td>
                            <td>O(1)</td>
                            <td>O(1)</td>
                        </tr>
                        <tr>
                            <td>Delete at Head</td>
                            <td>O(1)</td>
                            <td>O(1)</td>
                            <td>O(1)</td>
                        </tr>
                        <tr>
                            <td>Delete at Tail</td>
                            <td>O(n)</td>
                            <td>O(1)</td>
                            <td>O(1)</td>
                        </tr>
                        <tr>
                            <td>Memory per Node</td>
                            <td>1 pointer</td>
                            <td>2 pointers</td>
                            <td>1-2 pointers</td>
                        </tr>
                        <tr>
                            <td>Traversal</td>
                            <td>Forward only</td>
                            <td>Bidirectional</td>
                            <td>Circular</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="faq-section">
                <h3 class="section-title"><i class="fas fa-question-circle"></i> Frequently Asked Questions</h3>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Which linked list type is the best?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>It depends on your use case:</p>
                        <ul>
                            <li><strong>Singly</strong> is most memory-efficient for forward-only traversal</li>
                            <li><strong>Doubly</strong> allows bidirectional traversal at the cost of more memory</li>
                            <li><strong>Circular</strong> is ideal for cyclic data or round-robin systems</li>
                        </ul>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>When should I use arrays instead of linked lists?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Use arrays when:</p>
                        <ul>
                            <li>You need random access to elements (O(1) access time)</li>
                            <li>Memory usage is critical (arrays use less memory per element)</li>
                            <li>You know the maximum size in advance</li>
                        </ul>
                        <p>Use linked lists when:</p>
                        <ul>
                            <li>You need frequent insertions/deletions (especially at ends)</li>
                            <li>You don't know the size in advance</li>
                            <li>Memory fragmentation is a concern</li>
                        </ul>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>What are the real-world applications of linked lists?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <ul>
                            <li><strong>Music/Video Playlists</strong> - Next/previous navigation</li>
                            <li><strong>Browser History</strong> - Back/forward buttons</li>
                            <li><strong>Undo/Redo</strong> - In text editors and graphic software</li>
                            <li><strong>Memory Management</strong> - Memory allocation systems</li>
                            <li><strong>Hash Tables</strong> - Collision resolution using chaining</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Linked List Implementation
        class ListNode {
            constructor(value) {
                this.value = value;
                this.next = null;
                this.prev = null;
            }
        }

        class LinkedList {
            constructor(type = 'singly') {
                this.head = null;
                this.tail = null;
                this.size = 0;
                this.type = type;
            }

            addToHead(value) {
                const newNode = new ListNode(value);
                
                if (!this.head) {
                    this.head = newNode;
                    this.tail = newNode;
                    if (this.type === 'circular') {
                        newNode.next = newNode;
                        if (this.type.includes('doubly')) newNode.prev = newNode;
                    }
                } else {
                    newNode.next = this.head;
                    if (this.type.includes('doubly')) {
                        this.head.prev = newNode;
                    }
                    this.head = newNode;
                    
                    if (this.type === 'circular') {
                        this.tail.next = this.head;
                        if (this.type.includes('doubly')) this.head.prev = this.tail;
                    }
                }
                
                this.size++;
                return newNode;
            }

            addToTail(value) {
                const newNode = new ListNode(value);
                
                if (!this.tail) {
                    this.head = newNode;
                    this.tail = newNode;
                    if (this.type === 'circular') {
                        newNode.next = newNode;
                        if (this.type.includes('doubly')) newNode.prev = newNode;
                    }
                } else {
                    this.tail.next = newNode;
                    if (this.type.includes('doubly')) {
                        newNode.prev = this.tail;
                    }
                    this.tail = newNode;
                    
                    if (this.type === 'circular') {
                        this.tail.next = this.head;
                        if (this.type.includes('doubly')) this.head.prev = this.tail;
                    }
                }
                
                this.size++;
                return newNode;
            }

            removeFromHead() {
                if (!this.head) return null;
                
                const removedNode = this.head;
                
                if (this.head === this.tail) {
                    this.head = null;
                    this.tail = null;
                } else {
                    this.head = this.head.next;
                    if (this.type.includes('doubly') && this.head) {
                        this.head.prev = null;
                    }
                    
                    if (this.type === 'circular') {
                        this.tail.next = this.head;
                        if (this.type.includes('doubly') && this.head) {
                            this.head.prev = this.tail;
                        }
                    }
                }
                
                this.size--;
                return removedNode;
            }

            removeFromTail() {
                if (!this.tail) return null;
                
                const removedNode = this.tail;
                
                if (this.head === this.tail) {
                    this.head = null;
                    this.tail = null;
                } else {
                    if (this.type.includes('doubly')) {
                        this.tail = this.tail.prev;
                        this.tail.next = null;
                    } else {
                        // For singly linked list, we need to find the node before tail
                        let current = this.head;
                        while (current.next !== this.tail) {
                            current = current.next;
                        }
                        this.tail = current;
                        this.tail.next = null;
                    }
                    
                    if (this.type === 'circular') {
                        this.tail.next = this.head;
                        if (this.type.includes('doubly') && this.head) {
                            this.head.prev = this.tail;
                        }
                    }
                }
                
                this.size--;
                return removedNode;
            }

            search(value) {
                if (!this.head) return null;
                
                let current = this.head;
                let index = 0;
                
                do {
                    if (current.value === value) {
                        return { node: current, index };
                    }
                    current = current.next;
                    index++;
                } while (current && current !== this.head && index < this.size);
                
                return null;
            }

            reverse() {
                if (!this.head || this.head === this.tail) return;
                
                let prev = null;
                let current = this.head;
                let next = null;
                
                // For circular lists, break the circle temporarily
                if (this.type === 'circular') {
                    this.tail.next = null;
                    if (this.type.includes('doubly')) this.head.prev = null;
                }
                
                while (current) {
                    next = current.next;
                    current.next = prev;
                    
                    if (this.type.includes('doubly')) {
                        current.prev = next;
                    }
                    
                    prev = current;
                    current = next;
                }
                
                // Swap head and tail
                [this.head, this.tail] = [this.tail, this.head];
                
                // Restore circular connections if needed
                if (this.type === 'circular') {
                    this.tail.next = this.head;
                    if (this.type.includes('doubly')) this.head.prev = this.tail;
                }
            }

            clear() {
                this.head = null;
                this.tail = null;
                this.size = 0;
            }
        }

        // Global variables
        let currentList = new LinkedList('singly');
        let isDarkMode = true;

        // DOM Elements
        const nodesContainer = document.getElementById('nodes-container');
        const nodeCountElement = document.getElementById('node-count');
        const listTypeElement = document.getElementById('list-type');
        const memoryUsageElement = document.getElementById('memory-usage');

        // Initialize the application
        function init() {
            setupEventListeners();
            updateVisualization();
        }

        // Set up event listeners
        function setupEventListeners() {
            // List type selection
            document.getElementById('singly-tag').addEventListener('click', () => switchListType('singly'));
            document.getElementById('doubly-tag').addEventListener('click', () => switchListType('doubly'));
            document.getElementById('circular-tag').addEventListener('click', () => switchListType('circular'));
            
            // Operations
            document.getElementById('add-head-btn').addEventListener('click', addToHead);
            document.getElementById('add-tail-btn').addEventListener('click', addToTail);
            document.getElementById('remove-head-btn').addEventListener('click', removeFromHead);
            document.getElementById('remove-tail-btn').addEventListener('click', removeFromTail);
            document.getElementById('search-btn').addEventListener('click', searchValue);
            document.getElementById('clear-search-btn').addEventListener('click', clearSearch);
            document.getElementById('reverse-btn').addEventListener('click', reverseList);
            document.getElementById('clear-list-btn').addEventListener('click', clearList);
            
            // Theme toggle
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            
            // FAQ accordion
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                item.querySelector('.faq-question').addEventListener('click', () => {
                    item.classList.toggle('active');
                });
            });
        }

        // Switch between list types
        function switchListType(type) {
            // Update active tag
            document.querySelectorAll('.type-tag').forEach(tag => tag.classList.remove('active'));
            document.getElementById(`${type}-tag`).classList.add('active');
            
            // Update info section
            document.querySelectorAll('.algorithm-info').forEach(info => info.classList.remove('active'));
            document.getElementById(`${type}-info`).classList.add('active');
            
            // Convert current list to new type
            const values = [];
            let current = currentList.head;
            for (let i = 0; i < currentList.size; i++) {
                values.push(current.value);
                current = current.next;
            }
            
            // Create new list of the selected type
            let listType = type;
            if (type === 'circular') {
                listType = 'circular'; // Default to singly circular
            } else if (type === 'doubly') {
                listType = 'doubly';
            }
            
            currentList = new LinkedList(listType);
            
            // Add values back to the list
            values.forEach(value => {
                currentList.addToTail(value);
            });
            
            // Update visualization
            updateVisualization();
        }

        // Add node to head
        function addToHead() {
            const value = parseInt(document.getElementById('node-value').value) || 1;
            currentList.addToHead(value);
            updateVisualization();
            highlightNode(currentList.head, 1500);
        }

        // Add node to tail
        function addToTail() {
            const value = parseInt(document.getElementById('node-value').value) || 1;
            currentList.addToTail(value);
            updateVisualization();
            highlightNode(currentList.tail, 1500);
        }

        // Remove node from head
        function removeFromHead() {
            if (currentList.size === 0) {
                alert('List is already empty!');
                return;
            }
            
            const removedNode = currentList.removeFromHead();
            updateVisualization();
            
            if (removedNode) {
                // Show a temporary message about the removed node
                showTemporaryMessage(`Removed node with value: ${removedNode.value}`);
            }
        }

        // Remove node from tail
        function removeFromTail() {
            if (currentList.size === 0) {
                alert('List is already empty!');
                return;
            }
            
            const removedNode = currentList.removeFromTail();
            updateVisualization();
            
            if (removedNode) {
                // Show a temporary message about the removed node
                showTemporaryMessage(`Removed node with value: ${removedNode.value}`);
            }
        }

        // Search for a value
        function searchValue() {
            const value = parseInt(document.getElementById('node-value').value) || 1;
            const result = currentList.search(value);
            
            if (result) {
                highlightNode(result.node, 3000);
                showTemporaryMessage(`Found value ${value} at position ${result.index}`);
            } else {
                showTemporaryMessage(`Value ${value} not found in the list`, 'error');
            }
        }

        // Clear search highlights
        function clearSearch() {
            updateVisualization();
        }

        // Reverse the list
        function reverseList() {
            if (currentList.size < 2) {
                showTemporaryMessage('List needs at least 2 nodes to reverse', 'warning');
                return;
            }
            
            currentList.reverse();
            updateVisualization();
            showTemporaryMessage('List reversed successfully!');
        }

        // Clear the entire list
        function clearList() {
            if (currentList.size === 0) {
                alert('List is already empty!');
                return;
            }
            
            if (confirm('Are you sure you want to clear the entire list?')) {
                currentList.clear();
                updateVisualization();
                showTemporaryMessage('List cleared successfully!');
            }
        }

        // Update the visualization
        function updateVisualization() {
            // Update stats
            nodeCountElement.textContent = currentList.size;
            listTypeElement.textContent = 
                currentList.type === 'singly' ? 'Singly' : 
                currentList.type === 'doubly' ? 'Doubly' : 
                currentList.type.includes('circular') ? 'Circular' : 'Unknown';
            
            // Calculate memory usage (approximate)
            const memoryUsage = currentList.size * (currentList.type.includes('doubly') ? 48 : 32);
            memoryUsageElement.textContent = `${memoryUsage} B`;
            
            // Clear the container
            nodesContainer.innerHTML = '';
            
            if (currentList.size === 0) {
                // Show empty state
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-list-alt icon" style="font-size: 3rem; margin-bottom: 15px; color: var(--text-light);"></i>
                    <p style="color: var(--text-light);">Your linked list is empty. Add some nodes to get started!</p>
                `;
                nodesContainer.appendChild(emptyState);
                return;
            }
            
            if (currentList.type.includes('circular') && currentList.size > 1) {
                renderCircularList();
            } else {
                renderLinearList();
            }
        }

        // Render linear list (singly or doubly)
        function renderLinearList() {
            let current = currentList.head;
            let index = 0;
            
            while (current) {
                const nodeElement = createNodeElement(current, index);
                nodesContainer.appendChild(nodeElement);
                
                // Add arrow if there's a next node
                if (current.next) {
                    const arrow = document.createElement('div');
                    arrow.className = 'arrow';
                    if (currentList.type.includes('doubly')) {
                        arrow.classList.add('prev');
                    }
                    nodesContainer.appendChild(arrow);
                }
                
                current = current.next;
                index++;
                
                // Safety check to prevent infinite loops
                if (index > currentList.size) break;
            }
        }

        // Render circular list
        function renderCircularList() {
            const circularContainer = document.createElement('div');
            circularContainer.className = 'circular-container';
            nodesContainer.appendChild(circularContainer);
            
            const radius = 120;
            const centerX = 150;
            const centerY = 150;
            
            let current = currentList.head;
            let index = 0;
            
            do {
                const angle = (2 * Math.PI * index) / currentList.size;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                
                const nodeElement = document.createElement('div');
                nodeElement.className = 'circular-node';
                nodeElement.style.left = `${x}px`;
                nodeElement.style.top = `${y}px`;
                
                nodeElement.innerHTML = `
                    <div class="circular-node-value">${current.value}</div>
                `;
                
                circularContainer.appendChild(nodeElement);
                
                // Add arrow to next node
                if (current.next) {
                    const nextAngle = (2 * Math.PI * (index + 1)) / currentList.size;
                    const nextX = centerX + radius * Math.cos(nextAngle);
                    const nextY = centerY + radius * Math.sin(nextAngle);
                    
                    const arrow = document.createElement('div');
                    arrow.className = 'circular-arrow';
                    
                    const length = Math.sqrt(Math.pow(nextX - x, 2) + Math.pow(nextY - y, 2));
                    const angleDeg = Math.atan2(nextY - y, nextX - x) * 180 / Math.PI;
                    
                    arrow.style.width = `${length}px`;
                    arrow.style.left = `${x}px`;
                    arrow.style.top = `${y}px`;
                    arrow.style.transform = `rotate(${angleDeg}deg)`;
                    
                    circularContainer.appendChild(arrow);
                }
                
                current = current.next;
                index++;
            } while (current && current !== currentList.head && index < currentList.size);
        }

        // Create a node element
        function createNodeElement(node, index) {
            const nodeElement = document.createElement('div');
            nodeElement.className = 'node';
            nodeElement.dataset.index = index;
            nodeElement.dataset.value = node.value;
            
            let pointersHTML = '';
            
            if (currentList.type.includes('doubly')) {
                pointersHTML += `
                    <div class="pointer prev ${!node.prev ? 'null' : ''}">
                        ${node.prev ? '' : ''}
                    </div>
                `;
            }
            
            nodeElement.innerHTML = `
                ${pointersHTML}
                <div class="node-value">${node.value}</div>
                <div class="pointer next ${!node.next ? 'null' : ''}">
                    ${node.next ? '' : ''}
                </div>
            `;
            
            return nodeElement;
        }

        // Highlight a specific node
        function highlightNode(node, duration = 2000) {
            updateVisualization();
            
            setTimeout(() => {
                let current = currentList.head;
                let index = 0;
                
                while (current) {
                    if (current === node) {
                        const nodeElement = document.querySelector(`.node[data-index="${index}"]`) || 
                                          document.querySelector(`.circular-node:nth-child(${index + 1})`);
                        if (nodeElement) {
                            nodeElement.classList.add('highlight');
                        }
                        break;
                    }
                    
                    current = current.next;
                    index++;
                    
                    // Safety check
                    if (index > currentList.size) break;
                }
            }, 100);
            
            // Remove highlight after duration
            setTimeout(() => {
                document.querySelectorAll('.node, .circular-node').forEach(el => {
                    el.classList.remove('highlight');
                });
            }, duration);
        }

        // Show temporary message
        function showTemporaryMessage(message, type = 'success') {
            // Remove any existing message
            const existingMessage = document.querySelector('.temporary-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            // Create new message
            const messageElement = document.createElement('div');
            messageElement.className = `temporary-message ${type}`;
            messageElement.textContent = message;
            messageElement.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? 'var(--danger-color)' : type === 'warning' ? 'var(--warning-color)' : 'var(--success-color)'};
                color: white;
                padding: 12px 20px;
                border-radius: var(--border-radius);
                box-shadow: var(--shadow);
                z-index: 1000;
                font-weight: 600;
                transition: var(--transition);
            `;
            
            document.body.appendChild(messageElement);
            
            // Remove after 3 seconds
            setTimeout(() => {
                messageElement.style.opacity = '0';
                setTimeout(() => {
                    messageElement.remove();
                }, 300);
            }, 3000);
        }

        // Toggle between dark and light mode
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('light-mode', !isDarkMode);
            
            const themeToggle = document.getElementById('theme-toggle');
            const icon = themeToggle.querySelector('i');
            
            if (isDarkMode) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
            }
        }

        // Start the application when the page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>